
<style>
  /* Hide Quill toolbar in preview mode */
  .text-preview-quill .ql-toolbar {
    display: none !important;
  }
  
  /* Make Quill editor look like regular content */
  .text-preview-quill .ql-container {
    border: none !important;
    background: transparent !important;
  }
  
  .text-preview-quill .ql-editor {
    padding: 0 !important;
    background: transparent !important;
    color: white !important;
  }
  
  /* Ensure lists display properly */
  .text-preview-quill .ql-editor ul {
    list-style-type: disc;
    margin-left: 1.5rem;
  }
  
  .text-preview-quill .ql-editor ol {
    list-style-type: decimal;
    margin-left: 1.5rem;
  }
  
  .text-preview-quill .ql-editor li {
    list-style-position: outside;
  }
</style>

<div class="p-4 rounded-lg h-full"
     :style="{
       minHeight: card.size.height === 1 ? '200px' : 
                 card.size.height === 2 ? '300px' : 
                 card.size.height === 3 ? '400px' : 
                 card.size.height === 4 ? '500px' : '600px'
     }"
     :class="[
       card.config.backgroundColor || 'bg-gray-800',
       card.config.showBorder ? (card.config.borderColor || 'border-gray-600') + ' border' : ''
     ]"
     x-data="{ previewQuill: null }">

  <!-- Content Display -->
  <div class="text-white h-full">
    <div x-show="card.config.content" class="h-full">
      <!-- Quill Preview Editor -->
      <div 
        x-ref="textPreviewQuill"
        x-init="
          setTimeout(() => {
            if (!previewQuill) {
              previewQuill = new Quill($refs.textPreviewQuill, {
                theme: 'snow',
                readOnly: true,
                modules: {
                  toolbar: false
                }
              });
              
              // Set initial content using getContents/setContents approach
              if (card.config.content) {
                // Create a temporary editor to parse the HTML content
                const tempDiv = document.createElement('div');
                tempDiv.innerHTML = card.config.content;
                const tempQuill = new Quill(tempDiv, { theme: 'snow' });
                const delta = tempQuill.getContents();
                previewQuill.setContents(delta);
              }
              
              // Watch for content changes and update using Delta
              Alpine.effect(() => {
                if (card.config.content && previewQuill) {
                  const tempDiv = document.createElement('div');
                  tempDiv.innerHTML = card.config.content;
                  const tempQuill = new Quill(tempDiv, { theme: 'snow' });
                  const delta = tempQuill.getContents();
                  
                  // Only update if content is different
                  const currentDelta = previewQuill.getContents();
                  if (JSON.stringify(delta) !== JSON.stringify(currentDelta)) {
                    previewQuill.setContents(delta);
                  }
                }
              });
            }
          }, 100);
        "
        class="text-preview-quill h-full">
      </div>
    </div>
    
    <div x-show="!card.config.content" class="text-gray-400 text-center py-8">
      <p>No content configured</p>
      <p class="text-sm mt-2">Configure the text content in the editor</p>
    </div>
  </div>
</div>
